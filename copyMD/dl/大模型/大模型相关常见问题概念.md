---
title: 大模型相关常见问题概念
top: false
cover: false
toc: true
mathjax: true
date: 2024-07-23 15:27:31
password:
summary:
tags:
- pytorch
- 推理
- LLM
categories:
- 学术
---



# 背景

有些东西，名词，经常听见，也大概知道是什么意思，但是就是总记不住，列个case。



# 幻觉

**如果AI模型所生成输出没有任何已知事实的支持，幻觉便会发生。**产生与训练数据不一致或与输入无关的输出的模型。

简而言之：一本正经，胡说八道

包括RAG在内的自回归模型中幻觉的不可避免性可以最小化，但不能完全根除。



# RAG相关

## 向量数据库

### HNSW算法

HNSW（Hierarchical Navigable Small World）算法是一种用于**高效近似最近邻搜索**（Approximate Nearest Neighbor Search, ANNS）的图结构算法。它在处理高维数据时表现出色，广泛应用于图像检索、推荐系统、自然语言处理等领域。HNSW算法的核心思想是通过构建一个分层的小世界图（Small World Graph），**使得在高维空间中进行近似最近邻搜索变得更加高效。**

**HNSW算法的基本原理**

1. **分层结构**：HNSW构建了一个多层次的图结构，每一层都是一个小世界图。顶层的图节点较少，底层的图节点较多。每一层的图都是前一层的子集，顶层的图节点是底层图节点的超集。
2. **小世界图**：每一层的图都是一个小世界图，具有较短的平均路径长度和较高的聚类系数。小世界图的特性使得在图中进行搜索时，可以快速接近目标节点。
3. **导航机制**：搜索过程从顶层开始，逐层向下进行。在每一层中，算法会从当前节点的邻居中选择最接近目标节点的节点，直到到达底层。在底层进行精确的近邻搜索。



## 多路召回重排

### RRF

### RF的基本原理

**倒数排序融合（RRF）**是基于倒数排名的概念。其核心思想是，一个项目在各个源中的排名的倒数可以被累加，从而得到一个综合分数，用于最终的排名。RRF的公式如下：

![img](https://cdn.jsdelivr.net/gh/kengerlwl/kengerlwl.github.io/image/b097c8b7700f2508ebb1f27f6bab4d5b/b5120cd3566f65794b810a7ef13c03b0.png)



- 其中，**rank*i* 是一个项目在第 *i* 个源中的排名。**（倒数可以让排名越高，得到的分数越高）
- *k* 是源的数量。
- *c* 是一个**常数，通常设为60，用于减轻排名靠后的项目的权重。**





# Chat 和 Completion 的区别



OpenAI的ChatCompletion和Completion都是自然语言生成模型的接口，但它们的用途和应用场景略有不同。

|          | ChatCompletion                                               | Completion                                                   |
| -------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 区别     | 专为生成**对话和聊天**场景而设计。                           | 是一个**通用**的自然语言生成接口，支持生成各种类型的文本，包括段落、摘要、建议、答案等等。 |
| 适用场景 | ChatCompletion接口生成的文本通常会更具有人类对话的风格和语调，可以用于智能客服、聊天机器人等场景，以及在日常聊天中帮助用户自动生成回复。 | **Completion接口的输出更为多样化，可能会更加严谨和专业，适用于各种文本生成场景，例如文章创作、信息提取、机器翻译、自然语言问题回答等等。** |

本质上，是类似的，都是通过构造prompt输入给大模型，只是输入的方式不一样，一个是直接总结好所有的背景，要求输入给大模型，一个是把历史对话记录输入给大模型。



## ChatCompletion

```python
# Note: you need to be using OpenAI Python v0.27.0 for the code below to work
import openai

openai.ChatCompletion.create(
  model="gpt-3.5-turbo",
  messages=[
        {"role": "system", "content": "You are a helpful assistant."},
        {"role": "user", "content": "Who won the world series in 2020?"},
        {"role": "assistant", "content": "The Los Angeles Dodgers won the World Series in 2020."},
        {"role": "user", "content": "Where was it played?"}
    ]
)
```

messages必须是消息对象的数组，其中每个对象都有一个角色（“system”、“user”、“assistant”）和内容（消息的内容）。对话可以短至 1 条消息或填满许多页面。

通常，对话的格式首先是system消息，然后是交替的user和assistant消息。

- system消息有助于设置聊天AI助手的行为。在上面的例子中，被指示“你是一个乐于助人的助手”。
- user消息有助于指示助手。它们可以由应用程序的最终用户生成，也可以由开发人员设置为指令。
- assistant消息有助于存储先前的响应。它们**也可以由开发人员编写，以帮助提供所需行为的示例。**









# 微调

## RLHF

## MOE





# ref



[大型语言模型的幻觉问题_大语言模型幻觉问题-CSDN博客](https://blog.csdn.net/wdnshadow/article/details/135433235?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-1-135433235-blog-134389457.235^v43^pc_blog_bottom_relevance_base2&spm=1001.2101.3001.4242.2&utm_relevant_index=2)

[Reciprocal Rank Fusion (RRF) – 我的AI](https://www.aithinkings.com.cn/?p=76)
